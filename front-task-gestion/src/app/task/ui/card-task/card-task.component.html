<div class="task-card-wrapper" [attr.data-status]="task.status">
  <p-card [styleClass]="'task-card ' + getCardClass()">
    <div class="card-content">
      <!-- Status indicator bar -->
      <div class="status-bar" [style.background]="getStatusColor()"></div>
      
      <!-- Header -->
      <div class="card-header">
        <div class="title-section">
          <h3 class="task-title">{{ task.title }}</h3>
          @if (task.priority) {
            <span class="priority-badge" [attr.data-priority]="task.priority">
              {{ getPriorityLabel() }}
            </span>
          }
        </div>
        <p-tag 
          [value]="getStatusLabel()" 
          [severity]="getStatusSeverity()"
          [styleClass]="'status-tag'">
        </p-tag>
      </div>

      <!-- Description -->
      <p class="task-description">{{ task.description }}</p>

      <!-- Footer -->
      <div class="card-footer">
        <div class="task-meta">
          @if (task.assignedTo) {
            <div class="meta-item">
              <p-avatar 
                [label]="getInitials(task.assignedTo)" 
                size="normal"
                [styleClass]="'avatar-custom'">
              </p-avatar>
              <span class="meta-text">{{ task.assignedTo }}</span>
            </div>
          }
          @if (task.dueDate) {
            <div class="meta-item" [class.overdue]="isOverdue()">
              <i class="pi pi-calendar"></i>
              <span class="meta-text">{{ task.dueDate | date:'dd MMM' }}</span>
            </div>
          }
        </div>
        
        <!-- Action button -->
        <div class="action-section">
          @if (task.status !== 'completado') {
            <p-button 
              [label]="getActionLabel()" 
              [icon]="getActionIcon()"
              [severity]="getActionSeverity()"
              [rounded]="true"
              size="small"
              [styleClass]="'action-button'"
              (onClick)="onStatusChange()">
            </p-button>
          } @else {
            <div class="completed-badge">
              <i class="pi pi-check-circle"></i>
              <span>Completada</span>
            </div>
          }
        </div>
      </div>
    </div>
  </p-card>
</div>